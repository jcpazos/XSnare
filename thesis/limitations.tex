\section{Limitations and Future Work}

\textbf{Generalizability.} Our study has mostly covered WordPress websites and only 4 other sites. While many websites, in particular ones that use any kind of CMS might share similar structures to the ones we studied, it is clear that the open source nature and availability of WordPress code and its plugins might have made our assumption of full knowledge of the HTML too strong. This assumption may not always hold true. But, as the other CVEs we studied show, our tool is not limited to WordPress sites.

\textbf{Scope of study.} Our CVE study only covered 100 CVEs, 23 of which had to be discarded in our analysis. We intend to cover more in the future to have a better representation of WordPress websites, plugins, and the web as a whole. 

\textbf{Current implementation.} %% There are several aspects of injections that we have not been able to test as a result of the CVEs not exploiting these, like attacks through images. 
Our prototype lacks several performance enhancements which would lower the extension's overhead, like parallelizing signature loading and sanitization, and storing signatures in more efficient data structures.

\textbf{False positives and false negatives.} Due to the nature of our approach, it is impossible to completely get rid of FPs. We aim to reproduce the developer's intention with regards to when scripts should be able to run. However, this won't always be possible, as there will be cases where there are injection points where non-malicious JavaScript is allowed. If the sanitization applied targets JavaScript code, for example, a FP will likely be triggered.

Furthermore, since we rely on handwritten signatures to defend against attacks, vulnerable sites for which no signature has been written will be subject to FNs. In the future, we intend to study the rate of FPs and FNs in our approach and compare it to previous work. 

%% Faulty sanitization could be reduced by implementing our sanitization methods as a lexer instead of the declarative version we currently have: The signature developer would ideally provide the allowed behaviour in a given injection point, and the detector would check the injection content against the specified behaviour, providing a proof of whether the content could have been generated by following the rules. This would make sanitization more accurate.

\textbf{Usability.} A main aspect of our work is its increased potential for usability and adoption from both a user's perspective that installs the extension to defend themselves against \ac{XSS}, and a signature developer that has to write the database descriptions according to a known CVE. Future work could focus on usability studies related to both of these components.

\textbf{Protection against CSRF.} We believe we can adapt our work to defend against Cross-site request forgery (CSRF) exploits, as well. Using a similar signature language as the one for \ac{XSS}, a signature developer could specify pages with potential vulnerabilities to only allow network requests that cannot exploit such vulnerabilities. 

%% While our work has only focused on \ac{XSS}, we believe we can easily adapt our network filter to defend against CSRF exploits as well. Using a similar signature language as the one for \ac{XSS}, a signature developer could specify pages with potential vulnerabilities to only allow network requests that can not exploit such vulnerabilities. In some scenarios, it might be useful to track DOM events, e.g., user clicks to protect against click-jacking attacks. This kind of information is not available to the network; however, the extension could install a script on the page to monitor these actions. 

\textbf{Dealing with an increasing number of signatures.} As the number of framework probes increases, and more types of sites are covered, the performance impact will increase. More efficient approaches at searching and filtering, and for the data structures used in the signature database could be used to lower the performance overhead.

%% As of September 2019, CVE Details had 14894 \ac{XSS} vulnerabilities in its database \cite{vulnbytype}. This means that our current signatures only cover 0.5\% of all existing \ac{XSS} vulnerabilities. More efficient approaches at searching and filtering, as well as for the data structures used in the signature database could be applied to maintain a low performance overhead. The task of signature filtering, for example, is embarrassingly parallel in the number of signatures.

\textbf{Design considerations}. In our current implementation, each browser user has to install our extension. However, the same functionality could be offloaded to a single processing unit similar to a proxy, which handles the filtering for all machines in a network. This deployment model might be more feasible for certain environments.

%% While any user could alter their local signature database, most will not have the technical expertise to do so. However, a trusted community of users could flag websites as being potentially malicious as part of a separate database, saving time for others. 

%% We continue working on the system to make it more robust, both in terms of being able to defend against a myriad of attacks, as well as providing ease of development for signatures. 
