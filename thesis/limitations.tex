\section{Limitations and Future Work}

\textbf{Generalizability and scope of study.} As discussed in \autoref{methodology}, while many websites share similar structures to the ones we covered, our study only considered 4 other sites apart from those running on WordPress, and we only considered sites using a CMS. Not all websites might be identified as easily. Furthermore, we only studied 81 CVEs. %% , 24 of which had to be discarded in our analysis
In the future we intend to study a more diverse set of CVEs and go beyond CMS-based sites.
% in the future to have a better representation of WordPress websites, plugins, and the web as a whole.

\textbf{False positives and false negatives.} Due to the nature of our approach, it is extremely hard to completely get rid of FPs: If the applied sanitization targets JavaScript code, for example, a FP will likely be triggered. Furthermore, since we rely on handwritten signatures to defend against attacks, vulnerable sites for which no signature has been written will be subject to FNs. In the future, we intend to study the rate of FPs and FNs in our approach and compare it to previous work.

%% Faulty sanitization could be reduced by implementing our sanitization methods as a lexer instead of the declarative version we currently have: The signature developer would ideally provide the allowed behaviour in a given injection point, and the detector would check the injection content against the specified behaviour, providing a proof of whether the content could have been generated by following the rules. This would make sanitization more accurate.

\textbf{Usability.} A main aspect of our work is its increased potential for usability and adoption from both a user's perspective that installs the extension to defend themselves against \ac{XSS}, and a signature developer who has to write the database descriptions according to a known CVE. Future work could focus on usability studies related to both of these aspects.

\textbf{Protection against CSRF.} We believe that we can adapt our work to defend against \ac{CSRF} exploits, as well. Using a similar signature language as the one for \ac{XSS}, a signature developer could specify pages with potential vulnerabilities to only allow network requests that cannot exploit such vulnerabilities.

%% While our work has only focused on \ac{XSS}, we believe we can easily adapt our network filter to defend against \ac{CSRF} exploits as well. Using a similar signature language as the one for \ac{XSS}, a signature developer could specify pages with potential vulnerabilities to only allow network requests that can not exploit such vulnerabilities. In some scenarios, it might be useful to track DOM events, e.g., user clicks to protect against click-jacking attacks. This kind of information is not available to the network; however, the extension could install a script on the page to monitor these actions.

\textbf{Filtering network data.} Our extension filter's design depends on Firefox's implementation of the WebRequest API. In particular, the filterResponseData method allows the extension to modify an incoming HTTP request, and is only currently available in Firefox \footnote{https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/filterResponseData}. While
this feature has been previously requested on other browsers like Chrome, it has not received an implementation yet. This 
impacts our system's availability, limiting it to Firefox users.

\textbf{Dealing with an increasing number of signatures.} As the number of framework probes increases, and more types of sites are covered, the performance impact will increase. Using more efficient approaches to searching and filtering, and using better data structures in the signature database could to lower this overhead.

%% As of September 2019, CVE Details had 14894 \ac{XSS} vulnerabilities in its database \cite{vulnbytype}. This means that our current signatures only cover 0.5\% of all existing \ac{XSS} vulnerabilities. More efficient approaches at searching and filtering, as well as for the data structures used in the signature database could be applied to maintain a low performance overhead. The task of signature filtering, for example, is embarrassingly parallel in the number of signatures.

\textbf{Design considerations}. Currently, each browser user has to install our extension. However, the same functionality could be offloaded to a single processing unit similar to a proxy, which can handle the filtering for all machines in a network. This deployment model might be more appropriate in certain environments, such as in enterprises.

%% While any user could alter their local signature database, most will not have the technical expertise to do so. However, a trusted community of users could flag websites as being potentially malicious as part of a separate database, saving time for others.

%% We continue working on the system to make it more robust, both in terms of being able to defend against a myriad of attacks, as well as providing ease of development for signatures.
