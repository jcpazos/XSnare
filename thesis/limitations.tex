\section{Limitations and Future Work}
\textbf{Generalizability.} Our study has only covered WordPress websites. While many websites, in particular ones that use any kind of CMS might share similar structures to the ones we studied, it is clear that the open source nature and availability of WordPress code and its plugins might have made our assumption of full knowledge of the HTML too strong. We acknowledge that this assumption will not always hold true, however, many websites will still be able to benefit from our approach.

\textbf{Scope of study.} Our current CVE study has only covered 100 CVEs, 23 of which had to be discarded in our result analysis. We intend to cover more in the future to have a better representation of WordPress websites and plugins and the web as a whole. 

\textbf{Current implementation.} There are several aspects of injections that we have not been able to test as a result of the CVEs not exploiting these, like attacks through images. Our prototype implementation lacks several performance enhancements which would greatly benefit the overhead caused by the extension, like parallelizing signature loading and sanitization, as well as using more efficient data structures to store signatures. 

\textbf{False positives and false negatives.} Due to the nature of our approach, it is nigh impossible to completely get rid of false positives. While we concluded that the rate of false positives is very low for loaded signatures, these can still occur when a signature is correctly loaded, since the sanitization might erroneously delete valid elements. We have previously discussed the ability to reproduce the developer's intention with regards to when scripts should be able to run, however, this won't always be possible, as there will be cases where there are injection points where non-malicious JavaScript is allowed. If the sanitization applied targets JavaScript code, for example, a false positive will likely be triggered.

 Furthermore, since we rely on handwritten signatures to defend against attacks, exploits for which no signature has been written are not defended against, so it is possible that not every single injection point of every website will be covered, and there might also be false negatives. Additionally, other causes of false negatives like signature developer error (e.g. inaccurate signatures) are also possible. In the future, we intend to study the rate of false positives and negatives in our approach and compare it to previous work. Faulty sanitization could be reduced by implementing our sanitization methods as a lexer instead of the declarative version we currently have: The signature developer would ideally provide the allowed behaviour in a given injection point, and the detector would check the injection content against the signature-specified behaviour, providing a proof of whether the content could have been generated by following the rules. If the sanitizer determines that the content could not have been produced via the allowed set of rules, it would proceed to eliminate either the whole content itself, or the part of the content which is invalid.

\textbf{Usability.} A main aspect of our work is its increased potential for usability and adoption from both an user's perspective that installs the extension to defend themselves against XSS, and a signature developer that has to write the database descriptions according to a known CVE. Future work could focus on usability studies related to both of these components.

\textbf{Protection against CSRF.} While our work has only focused on XSS, we believe we can easily adapt our network filter to defend against CSRF exploits as well. Using a similar signature language as the one for XSS, a signature developer could specify pages with potential vulnerabilities and enforce network requests that can not exploit such vulnerabilities. In some scenarios, it might be useful to track DOM events, e.g. user clicks to protect against clickjacking attacks. This kind of information is not available to the network; however, the extension could install a script on the page to monitor these actions. 

\textbf{Dealing with an increasing amount of signatures.} Our naive approach at signature filtering, once a probe for a framework passes, has been effective with our current amount of signatures. However, as the number of signatures increases, and more types of sites are covered, the performance impact may increase drastically. As of September 2019, CVE Details had 14894 XSS vulnerabilities in its database \cite{vulnbytype}. This would mean that our current signatures only cover 0.5\% of all existing XSS vulnerabilities. More efficient approaches at searching and filtering, as well as for the data structures used in the signature database could be applied to maintain a low performance overhead. The task of signature filtering, for example, is embarrassingly parallel in the number of signatures. Most users will visit the same pages numerous times. Caching certain aspects of the filtering process can result in a improved performance over several loads: for example, if www.myblog.com does not run WordPress, it is unlikely to change this in the near future. In this case, we could cache the probing component and skip it entirely for the next load. (TODO: someone might know or have referenced to what firewalls do?)

\textbf{Design considerations}. Our current design allows a single filter to be used to protect multiple users. In our current implementation, each browser user has to install our extension. However, the same functionality could be offloaded to a single processing unit in the form of a proxy, which handles the filtering for all machines in a network. This deployment model might be more feasible for certain environments.

While any user could alter their local signature database, most will not have the technical expertise to do so. However, a trusted community of users could flag websites as being potentially malicious as part of a separate database, saving time for others. 

We continue working on the system to become more robust both in terms of being able to defend against a myriad of attacks, as well as providing ease of development for signatures. 
